"use strict";(self.webpackChunkmomraGisCore=self.webpackChunkmomraGisCore||[]).push([[1255],{79912:(e,t,i)=>{function r(){return new Float32Array(3)}function n(e){const t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(e,t,i){const r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=i,r}function a(){return r()}function o(){return s(1,1,1)}function l(){return s(1,0,0)}function c(){return s(0,1,0)}function h(){return s(0,0,1)}i.d(t,{a:()=>n,c:()=>r,f:()=>s});const u=a(),d=o(),f=l(),p=c(),m=h();Object.freeze({__proto__:null,create:r,clone:n,fromValues:s,createView:function(e,t){return new Float32Array(e,t,3)},zeros:a,ones:o,unitX:l,unitY:c,unitZ:h,ZEROS:u,ONES:d,UNIT_X:f,UNIT_Y:p,UNIT_Z:m})},56215:(e,t,i)=>{i.d(t,{AR:()=>g,Gr:()=>m,JG:()=>c,Ue:()=>l,Jk:()=>d,zk:()=>u,al:()=>h,KU:()=>f,ct:()=>p});var r=i(19431),n=i(19480),s=i(6766),a=i(8909),o=i(68817);function l(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}function c(e,t=l()){return h(e.origin,e.vector,t)}function h(e,t,i=l()){return(0,s.g)(i.origin,e),(0,s.g)(i.vector,t),i}function u(e,t,i=l()){return(0,s.g)(i.origin,e),(0,s.f)(i.vector,t,e),i}function d(e,t){const i=(0,s.f)(o.WM.get(),t,e.origin),n=(0,s.d)(e.vector,i),a=(0,s.d)(e.vector,e.vector),l=(0,r.uZ)(n/a,0,1),c=(0,s.f)(o.WM.get(),(0,s.a)(o.WM.get(),e.vector,l),i);return(0,s.d)(c,c)}function f(e,t,i){return(0,s.b)(i,e.origin,(0,s.a)(i,e.vector,t))}function p(e,t,i,n,a){const{vector:l,origin:c}=e,h=(0,s.f)(o.WM.get(),t,c),u=(0,s.d)(l,h)/(0,s.p)(l);return(0,s.a)(a,l,(0,r.uZ)(u,i,n)),(0,s.b)(a,a,e.origin)}function m(e,t){if(v(e,function(e,t){const i=x.get();return i.origin=e,i.vector=t,i}(t.origin,t.direction),!1,_)){const{tA:t,pB:i,distance2:r}=_;if(t>=0&&t<=1)return r;if(t<0)return(0,s.h)(e.origin,i);if(t>1)return(0,s.h)((0,s.b)(o.WM.get(),e.origin,e.vector),i)}return null}function g(e,t,i){return!!v(e,t,!0,_)&&((0,s.g)(i,_.pA),!0)}function v(e,t,i,n){const a=1e-6,l=e.origin,c=(0,s.b)(o.WM.get(),l,e.vector),h=t.origin,u=(0,s.b)(o.WM.get(),h,t.vector),d=o.WM.get(),f=o.WM.get();if(d[0]=l[0]-h[0],d[1]=l[1]-h[1],d[2]=l[2]-h[2],f[0]=u[0]-h[0],f[1]=u[1]-h[1],f[2]=u[2]-h[2],Math.abs(f[0])<a&&Math.abs(f[1])<a&&Math.abs(f[2])<a)return!1;const p=o.WM.get();if(p[0]=c[0]-l[0],p[1]=c[1]-l[1],p[2]=c[2]-l[2],Math.abs(p[0])<a&&Math.abs(p[1])<a&&Math.abs(p[2])<a)return!1;const m=d[0]*f[0]+d[1]*f[1]+d[2]*f[2],g=f[0]*p[0]+f[1]*p[1]+f[2]*p[2],v=d[0]*p[0]+d[1]*p[1]+d[2]*p[2],_=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],x=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*_-g*g;if(Math.abs(x)<a)return!1;let b=(m*g-v*_)/x,T=(m+g*b)/_;i&&(b=(0,r.uZ)(b,0,1),T=(0,r.uZ)(T,0,1));const S=o.WM.get(),w=o.WM.get();return S[0]=l[0]+b*p[0],S[1]=l[1]+b*p[1],S[2]=l[2]+b*p[2],w[0]=h[0]+T*f[0],w[1]=h[1]+T*f[1],w[2]=h[2]+T*f[2],n.tA=b,n.tB=T,n.pA=S,n.pB=w,n.distance2=(0,s.h)(S,w),!0}const _={tA:0,tB:0,pA:(0,a.c)(),pB:(0,a.c)(),distance2:0},x=new n.x((()=>({origin:null,vector:null})))},44883:(e,t,i)=>{i.d(t,{t:()=>n});var r=i(66341);async function n(e,t){const{data:i}=await(0,r.default)(e,{responseType:"image",...t});return i}},95650:(e,t,i)=>{i.d(t,{q:()=>n});var r=i(23410);function n(e,t){0===t.output&&t.receiveShadows?(e.varyings.add("linearDepth","float"),e.vertex.code.add(r.H`void forwardLinearDepth() { linearDepth = gl_Position.w; }`)):1===t.output||3===t.output?(e.varyings.add("linearDepth","float"),e.vertex.uniforms.add("cameraNearFar","vec2"),e.vertex.code.add(r.H`void forwardLinearDepth() {
linearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);
}`)):e.vertex.code.add(r.H`void forwardLinearDepth() {}`)}},5885:(e,t,i)=>{i.d(t,{p2:()=>o,Vv:()=>c,DA:()=>l});var r=i(61681),n=i(6766),s=i(8909),a=i(23410);function o(e,t){if(t.slicePlaneEnabled){e.extensions.add("GL_OES_standard_derivatives"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add("slicePlaneOrigin","vec3"),e.vertex.uniforms.add("slicePlaneBasis1","vec3"),e.vertex.uniforms.add("slicePlaneBasis2","vec3")),e.fragment.uniforms.add("slicePlaneOrigin","vec3"),e.fragment.uniforms.add("slicePlaneBasis1","vec3"),e.fragment.uniforms.add("slicePlaneBasis2","vec3");const i=a.H`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,r=a.H`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
if (sliceByFactors(factors)) {
return color;
}
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,n=t.sliceHighlightDisabled?a.H`#define highlightSlice(_color_, _pos_) (_color_)`:a.H`
        ${r}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;t.sliceEnabledForVertexPrograms&&e.vertex.code.add(i),e.fragment.code.add(i),e.fragment.code.add(n)}else{const i=a.H`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;t.sliceEnabledForVertexPrograms&&e.vertex.code.add(i),e.fragment.code.add(i)}}function l(e,t,i){c(e,t,i.slicePlane,i.origin)}function c(e,t,i,a){t.slicePlaneEnabled&&((0,r.pC)(i)?(a?((0,n.f)(h,i.origin,a),e.setUniform3fv("slicePlaneOrigin",h)):e.setUniform3fv("slicePlaneOrigin",i.origin),e.setUniform3fv("slicePlaneBasis1",i.basis1),e.setUniform3fv("slicePlaneBasis2",i.basis2)):(e.setUniform3fv("slicePlaneBasis1",s.Z),e.setUniform3fv("slicePlaneBasis2",s.Z),e.setUniform3fv("slicePlaneOrigin",s.Z)))}const h=(0,s.c)()},4731:(e,t,i)=>{i.d(t,{w:()=>n});var r=i(23410);function n(e,t){t.linearDepth?e.vertex.code.add(r.H`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):e.vertex.code.add(r.H`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},6502:(e,t,i)=>{i.d(t,{c:()=>n});var r=i(23410);function n(e,t){t.attributeColor?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(r.H`void forwardVertexColor() { vColor = color; }`),e.vertex.code.add(r.H`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):e.vertex.code.add(r.H`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},77700:(e,t,i)=>{i.d(t,{LC:()=>s,Mo:()=>a});var r=i(76774),n=i(23410);function s(e,t){const i=e.vertex.code;t.verticalOffsetEnabled?(e.vertex.uniforms.add("verticalOffset","vec4"),t.screenSizePerspectiveEnabled&&(e.include(r.c),e.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),i.add(n.H`
    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
      ${1===t.viewingMode?n.H`vec3 worldNormal = normalize(worldPos + localOrigin);`:n.H`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
      ${t.screenSizePerspectiveEnabled?n.H`
          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));
          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:n.H`
          float verticalOffsetScreenHeight = verticalOffset.x;`}
      // Screen sized offset in world space, used for example for line callouts
      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
      return worldNormal * worldOffset;
    }

    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      return worldPos + calculateVerticalOffset(worldPos, localOrigin);
    }
    `)):i.add(n.H`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}function a(e,t,i){if(!t.verticalOffset)return;const r=o(t.verticalOffset,i.camera.fovY,i.camera.fullViewport[3]),n=i.camera.pixelRatio||1;e.setUniform4f("verticalOffset",r.screenLength*n,r.perDistance,r.minWorldLength,r.maxWorldLength)}function o(e,t,i,r=l){return r.screenLength=e.screenLength,r.perDistance=Math.tan(.5*t)/(.5*i),r.minWorldLength=e.minWorldLength,r.maxWorldLength=e.maxWorldLength,r}const l={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},59004:(e,t,i)=>{i.d(t,{F:()=>s});var r=i(9794),n=i(23410);function s(e,t){e.fragment.include(r.n),3===t.output?(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(n.H`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 2.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`)):1===t.output&&e.fragment.code.add(n.H`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)}},55994:(e,t,i)=>{i.d(t,{bA:()=>o,wW:()=>l});var r=i(1983),n=i(23410);const s=(0,r.f)(1,1,0,1),a=(0,r.f)(1,0,1,1);function o(e){e.fragment.uniforms.add("depthTex","sampler2D"),e.fragment.uniforms.add("highlightViewportPixelSz","vec4"),e.fragment.constants.add("occludedHighlightFlag","vec4",s).add("unoccludedHighlightFlag","vec4",a),e.fragment.code.add(n.H`void outputHighlight() {
vec4 fragCoord = gl_FragCoord;
float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
if (fragCoord.z > sceneDepth + 5e-7) {
gl_FragColor = occludedHighlightFlag;
}
else {
gl_FragColor = unoccludedHighlightFlag;
}
}`)}function l(e,t){e.bindTexture(t.highlightDepthTexture,"depthTex"),e.setUniform4f("highlightViewportPixelSz",0,0,t.inverseViewport[0],t.inverseViewport[1])}},6665:(e,t,i)=>{i.d(t,{S:()=>s});var r=i(9794),n=i(23410);function s(e){e.include(r.n),e.code.add(n.H`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)}},73393:(e,t,i)=>{i.d(t,{p:()=>s,l:()=>n});var r=i(23410);function n(e,t){e.fragment.uniforms.add("terrainDepthTexture","sampler2D"),e.fragment.uniforms.add("cameraNearFar","vec2"),e.fragment.uniforms.add("inverseViewport","vec2"),e.fragment.code.add(r.H`
    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){

      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);
      if(fragmentDepth ${t.cullAboveGround?">":"<="} terrainDepth){
        discard;
      }
    }
  `)}function s(e,t){t.multipassTerrainEnabled&&t.terrainLinearDepthTexture&&e.bindTexture(t.terrainLinearDepthTexture,"terrainDepthTexture")}},89585:(e,t,i)=>{i.d(t,{T:()=>a});var r=i(23410);function n(e){const t=e.fragment.code;t.add(r.H`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)
{
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),t.add(r.H`float integratedRadiance(float cosTheta2, float roughness)
{
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),t.add(r.H`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)
{
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var s=i(95509);function a(e,t){const i=e.fragment.code;e.include(s.e),3===t.pbrMode||4===t.pbrMode?(i.add(r.H`
    struct PBRShadingWater
    {
        float NdotL;   // cos angle between normal and light direction
        float NdotV;   // cos angle between normal and view direction
        float NdotH;   // cos angle between normal and half vector
        float VdotH;   // cos angle between view direction and half vector
        float LdotH;   // cos angle between light direction and half vector
        float VdotN;   // cos angle between view direction and normal vector
    };

    float dtrExponent = ${t.useCustomDTRExponentForWater?"2.2":"2.0"};
    `),i.add(r.H`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),i.add(r.H`float normalDistributionWater(float NdotH, float roughness)
{
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),i.add(r.H`float geometricOcclusionKelemen(float LoH)
{
return 0.25 / (LoH * LoH);
}`),i.add(r.H`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)
{
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}
vec3 tonemapACES(const vec3 x) {
return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);
}`)):1!==t.pbrMode&&2!==t.pbrMode||(e.include(n),i.add(r.H`struct PBRShadingInfo
{
float NdotL;
float NdotV;
float NdotH;
float VdotH;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),i.add(r.H`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),i.add(r.H`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`),i.add(r.H`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`),i.add(r.H`float gamutMapChanel(float x, vec2 p){
return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );
}`),i.add(r.H`vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){
vec3 outColor;
vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));
outColor.x = gamutMapChanel(inColor.x, p) ;
outColor.y = gamutMapChanel(inColor.y, p) ;
outColor.z = gamutMapChanel(inColor.z, p) ;
return outColor;
}`))}},95509:(e,t,i)=>{i.d(t,{e:()=>n});var r=i(23410);function n(e){e.vertex.code.add(r.H`const float PI = 3.141592653589793;`),e.fragment.code.add(r.H`const float PI = 3.141592653589793;
const float LIGHT_NORMALIZATION = 1.0 / PI;
const float INV_PI = 0.3183098861837907;
const float HALF_PI = 1.570796326794897;`)}},20105:(e,t,i)=>{i.d(t,{hX:()=>s,O2:()=>a,mi:()=>l,vL:()=>o});var r=i(9794),n=i(23410);function s(e){e.fragment.include(r.n),e.fragment.uniforms.add("uShadowMapTex","sampler2D"),e.fragment.uniforms.add("uShadowMapNum","int"),e.fragment.uniforms.add("uShadowMapDistance","vec4"),e.fragment.uniforms.add("uShadowMapMatrix","mat4",4),e.fragment.uniforms.add("uDepthHalfPixelSz","float"),e.fragment.code.add(n.H`int chooseCascade(float _linearDepth, out mat4 mat) {
vec4 distance = uShadowMapDistance;
float depth = _linearDepth;
int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;
mat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];
return i;
}
vec3 lightSpacePosition(vec3 _vpos, mat4 mat) {
vec4 lv = mat * vec4(_vpos, 1.0);
lv.xy /= lv.w;
return 0.5 * lv.xyz + vec3(0.5);
}
vec2 cascadeCoordinates(int i, vec3 lvpos) {
return vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;
}
float readShadowMapDepth(vec2 uv, sampler2D _depthTex) {
return rgba2float(texture2D(_depthTex, uv));
}
float posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {
return readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;
}
float filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {
float texSize = 0.5 / halfPixelSize;
vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);
float s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);
float s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);
return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);
}
float readShadowMap(const in vec3 _vpos, float _linearDepth) {
mat4 mat;
int i = chooseCascade(_linearDepth, mat);
if (i >= uShadowMapNum) { return 0.0; }
vec3 lvpos = lightSpacePosition(_vpos, mat);
if (lvpos.z >= 1.0) { return 0.0; }
if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }
vec2 uv = cascadeCoordinates(i, lvpos);
return filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);
}`)}function a(e,t){t.shadowMappingEnabled&&(t.shadowMap.bind(e),t.shadowMap.bindView(e,t.origin))}function o(e,t,i){t.shadowMappingEnabled&&t.shadowMap.bindView(e,i)}function l(e,t){t.shadowMappingEnabled&&t.shadowMap.bindView(e,t.origin)}},12664:(e,t,i)=>{i.d(t,{kl:()=>n,kz:()=>s,uj:()=>o,s0:()=>a});var r=i(23410);function n(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(r.H`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),e.vertex.code.add(r.H`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${t.vvInstancingEnabled?r.H`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):e.vertex.code.add(r.H`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(r.H`
      uniform float vvColorValues[vvColorNumber];
      uniform vec4 vvColorColors[vvColorNumber];

      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${t.vvInstancingEnabled?r.H`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):e.vertex.code.add(r.H`vec4 vvColor() { return vec4(1.0); }`)}function s(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}function a(e,t){s(e,t),t.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",t.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",t.vvOpacityOpacities))}function o(e,t){s(e,t),t.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",t.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",t.vvSymbolRotationMatrix))}},41272:(e,t,i)=>{i.d(t,{sj:()=>a,F:()=>n,bf:()=>s});var r=i(23410);const n=.1,s=.001;function a(e,t){const i=e.fragment;switch(t.alphaDiscardMode){case 0:i.code.add(r.H`
        #define discardOrAdjustAlpha(color) { if (color.a < ${r.H.float(s)}) { discard; } }
      `);break;case 1:i.code.add(r.H`void discardOrAdjustAlpha(inout vec4 color) {
color.a = 1.0;
}`);break;case 2:i.uniforms.add("textureAlphaCutoff","float"),i.code.add(r.H`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }`);break;case 3:e.fragment.uniforms.add("textureAlphaCutoff","float"),e.fragment.code.add(r.H`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }`)}}},32394:(e,t,i)=>{i.d(t,{Y:()=>n});var r=i(23410);function n(e){e.code.add(r.H`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},9794:(e,t,i)=>{i.d(t,{n:()=>n});var r=i(23410);function n(e){e.code.add(r.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)}},76774:(e,t,i)=>{i.d(t,{c:()=>s,y:()=>a});var r=i(23410),n=i(25584);function s(e){e.vertex.code.add(r.H`float screenSizePerspectiveMinSize(float size, vec4 factor) {
float nonZeroSize = 1.0 - step(size, 0.0);
return (
factor.z * (
1.0 +
nonZeroSize *
2.0 * factor.w / (
size + (1.0 - nonZeroSize)
)
)
);
}`),e.vertex.code.add(r.H`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),e.vertex.code.add(r.H`vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
return vec4(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z,
params.w
);
}`),e.vertex.code.add(r.H`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
}`),e.vertex.code.add(r.H`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),e.vertex.code.add(r.H`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);
}`),e.vertex.code.add(r.H`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function a(e,t){if(t.screenSizePerspective){(0,n.bj)(t.screenSizePerspective,e,"screenSizePerspective");const i=t.screenSizePerspectiveAlignment||t.screenSizePerspective;(0,n.bj)(i,e,"screenSizePerspectiveAlignment")}}},84614:(e,t,i)=>{i.d(t,{fb:()=>n,D6:()=>a,II:()=>s,id:()=>l,q0:()=>o,yJ:()=>c});var r=i(24455);function n(e,t,i){e.setUniform3f("camPos",i[3]-t[0],i[7]-t[1],i[11]-t[2])}function s(e,t){e.setUniformMatrix4fv("proj",t)}function a(e,t){e.setUniform2fv("nearFar",t)}function o(e,t,i){(0,r.a)(h,i,t),e.setUniform3fv("localOrigin",t),e.setUniformMatrix4fv("view",h)}function l(e,t){o(e,t.origin,t.camera.viewMatrix)}function c(e,t){e.setUniform4fv("viewport",t.camera.fullViewport)}const h=(0,i(64790).c)()},3961:(e,t,i)=>{i.d(t,{kG:()=>s});const r=i(13802).Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class n{constructor(){this.includedModules=new Map}include(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&r.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,t),e(this.builder,t))}}class s extends n{constructor(){super(...arguments),this.vertex=new l,this.fragment=new l,this.attributes=new c,this.varyings=new h,this.extensions=new u,this.constants=new d}get fragmentUniforms(){return this.fragment.uniforms}get builder(){return this}generateSource(e){const t=this.extensions.generateSource(e),i=this.attributes.generateSource(e),r=this.varyings.generateSource(),n="vertex"===e?this.vertex:this.fragment,s=n.uniforms.generateSource(),a=n.code.generateSource(),o="vertex"===e?p:f,l=this.constants.generateSource().concat(n.constants.generateSource());return`\n${t.join("\n")}\n\n${o}\n\n${l.join("\n")}\n\n${s.join("\n")}\n\n${i.join("\n")}\n\n${r.join("\n")}\n\n${a.join("\n")}`}}class a{constructor(){this._entries=new Map}add(e,t,i){const r=`${e}_${t}_${i}`;return this._entries.set(r,{name:e,type:t,arraySize:i}),this}generateSource(){return Array.from(this._entries.values()).map((e=>{return`uniform ${e.type} ${e.name}${t=e.arraySize,t?`[${t}]`:""};`;var t}))}get entries(){return Array.from(this._entries.values())}}class o{constructor(){this._entries=new Array}add(e){this._entries.push(e)}generateSource(){return this._entries}}class l extends n{constructor(){super(...arguments),this.uniforms=new a,this.code=new o,this.constants=new d}get builder(){return this}}class c{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return"fragment"===e?[]:this._entries.map((e=>`attribute ${e[1]} ${e[0]};`))}}class h{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(){return this._entries.map((e=>`varying ${e[1]} ${e[0]};`))}}class u{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){const t="vertex"===e?u.ALLOWLIST_VERTEX:u.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>t.includes(e))).map((e=>`#extension ${e} : enable`))}}u.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],u.ALLOWLIST_VERTEX=[];class d{constructor(){this._entries=[]}add(e,t,i){let r="ERROR_CONSTRUCTOR_STRING";switch(t){case"float":r=d.numberToFloatStr(i);break;case"int":r=d.numberToIntStr(i);break;case"bool":r=i.toString();break;case"vec2":r=`vec2(${d.numberToFloatStr(i[0])},                            ${d.numberToFloatStr(i[1])})`;break;case"vec3":r=`vec3(${d.numberToFloatStr(i[0])},                            ${d.numberToFloatStr(i[1])},                            ${d.numberToFloatStr(i[2])})`;break;case"vec4":r=`vec4(${d.numberToFloatStr(i[0])},                            ${d.numberToFloatStr(i[1])},                            ${d.numberToFloatStr(i[2])},                            ${d.numberToFloatStr(i[3])})`;break;case"ivec2":r=`ivec2(${d.numberToIntStr(i[0])},                             ${d.numberToIntStr(i[1])})`;break;case"ivec3":r=`ivec3(${d.numberToIntStr(i[0])},                             ${d.numberToIntStr(i[1])},                             ${d.numberToIntStr(i[2])})`;break;case"ivec4":r=`ivec4(${d.numberToIntStr(i[0])},                             ${d.numberToIntStr(i[1])},                             ${d.numberToIntStr(i[2])},                             ${d.numberToIntStr(i[3])})`;break;case"mat2":case"mat3":case"mat4":r=`${t}(${Array.prototype.map.call(i,(e=>d.numberToFloatStr(e))).join(", ")})`}return this._entries.push(`const ${t} ${e} = ${r};`),this}static numberToIntStr(e){return e.toFixed(0)}static numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}}const f="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",p="precision highp float;\nprecision highp sampler2D;"},23410:(e,t,i)=>{function r(e,...t){let i="";for(let r=0;r<t.length;r++)i+=e[r]+t[r];return i+=e[e.length-1],i}i.d(t,{H:()=>r}),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r||(r={}))},9969:(e,t,i)=>{i.d(t,{J:()=>r});class r{constructor(e,t){this._module=e,this._loadModule=t}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}},52756:(e,t,i)=>{i.d(t,{A:()=>n});var r=i(61681);class n{constructor(e,t,i=(()=>this.dispose())){this.release=i,t&&(this._config=t.snapshot()),this._program=this.initializeProgram(e),this._pipeline=this.initializePipeline(e)}dispose(){this._program=(0,r.O3)(this._program),this._pipeline=this._config=null}reload(e){(0,r.O3)(this._program),this._program=this.initializeProgram(e)}get program(){return this._program}get key(){return this._config.key}get configuration(){return this._config}bindPass(e,t){}bindMaterial(e,t){}bindDraw(e){}bindPipelineState(e,t=null,i){e.setPipelineState(this.getPipelineState(t,i))}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}get primitiveType(){return 4}getPipelineState(e,t){return this._pipeline}}},67197:(e,t,i)=>{i.d(t,{m:()=>r,o:()=>n});class r{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits?this._parameterBits.map((()=>0)):[],this._parameterNames||(this._parameterNames=[])}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const e=this._parameterNames,t={key:this.key};for(const i of e)t[i]=this[i];return t}}function n(e={}){return(t,i)=>{var r,n;t._parameterNames=null!=(r=t._parameterNames)?r:[],t._parameterNames.push(i);const s=t._parameterNames.length-1,a=e.count||2,o=Math.ceil(Math.log2(a)),l=null!=(n=t._parameterBits)?n:[0];let c=0;for(;l[c]+o>16;)c++,c>=l.length&&l.push(0);t._parameterBits=l;const h=l[c],u=(1<<o)-1<<h;l[c]+=o,Object.defineProperty(t,i,{get(){return this[s]},set(e){if(this[s]!==e&&(this[s]=e,this._keyDirty=!0,this._parameterBits[c]=this._parameterBits[c]&~u|+e<<h&u,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration value for "+i+" must be boolean or number, got "+typeof e}})}}},10107:(e,t,i)=>{i.d(t,{c:()=>n});var r=i(7958);class n{constructor(){this.id=(0,r.D)()}unload(){}}},5474:(e,t,i)=>{i.d(t,{i:()=>r});const r=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]])},5079:(e,t,i)=>{i.d(t,{Z:()=>r});class r{constructor(e){this._material=e.material,this._techniqueRep=e.techniqueRep,this._output=e.output}dispose(){this._techniqueRep.release(this._technique)}get technique(){return this._technique}ensureTechnique(e,t,i=this._output){return this._technique=this._techniqueRep.releaseAndAcquire(e,this._material.getTechniqueConfig(i,t),this._technique),this._technique}ensureResources(e){return 2}}},11327:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(61681),n=i(5079);class s extends n.Z{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textureRepository=e.textureRep,this._textureId=e.textureId,this._acquire(e.textureId).then((e=>this._texture=e)),this._acquire(e.normalTextureId).then((e=>this._textureNormal=e)),this._acquire(e.emissiveTextureId).then((e=>this._textureEmissive=e)),this._acquire(e.occlusionTextureId).then((e=>this._textureOcclusion=e)),this._acquire(e.metallicRoughnessTextureId).then((e=>this._textureMetallicRoughness=e))}dispose(){this._texture=(0,r.RY)(this._texture),this._textureNormal=(0,r.RY)(this._textureNormal),this._textureEmissive=(0,r.RY)(this._textureEmissive),this._textureOcclusion=(0,r.RY)(this._textureOcclusion),this._textureMetallicRoughness=(0,r.RY)(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return 0===this._numLoading?2:1}updateTexture(e){((0,r.Wi)(this._texture)||e!==this._texture.id)&&(this._texture=(0,r.RY)(this._texture),this._textureId=e,this._acquire(this._textureId).then((e=>this._texture=e)))}bindTextures(e){(0,r.pC)(this._texture)&&e.bindTexture(this._texture.glTexture,"tex"),(0,r.pC)(this._textureNormal)&&e.bindTexture(this._textureNormal.glTexture,"normalTexture"),(0,r.pC)(this._textureEmissive)&&e.bindTexture(this._textureEmissive.glTexture,"texEmission"),(0,r.pC)(this._textureOcclusion)&&e.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),(0,r.pC)(this._textureMetallicRoughness)&&e.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")}bindTextureScale(e){const t=(0,r.pC)(this._texture)?this._texture.glTexture:null;(0,r.pC)(t)&&t.descriptor.textureCoordinateScaleFactor?e.setUniform2fv("textureCoordinateScaleFactor",t.descriptor.textureCoordinateScaleFactor):e.setUniform2f("textureCoordinateScaleFactor",1,1)}_acquire(e){return(0,r.Wi)(e)?Promise.resolve(null):(++this._numLoading,this._textureRepository.acquire(e).then((e=>this._disposed?((0,r.RY)(e),null):e)).finally((()=>--this._numLoading)))}}},96553:(e,t,i)=>{i.d(t,{Z:()=>d});var r=i(61681),n=i(17135),s=i(6766),a=i(8909),o=i(15095);class l{constructor(e,t,i,r){this.primitiveIndices=e,this._numIndexPerPrimitive=t,this.indices=i,this.position=r,this.center=(0,a.c)(),(0,o.hu)(e.length>=1),(0,o.hu)(i.length%this._numIndexPerPrimitive==0),(0,o.hu)(i.length>=e.length*this._numIndexPerPrimitive),(0,o.hu)(3===r.size||4===r.size);const{data:n,size:l}=r,h=e.length;let u=l*i[this._numIndexPerPrimitive*e[0]];c.clear(),c.push(u),this.bbMin=(0,a.f)(n[u],n[u+1],n[u+2]),this.bbMax=(0,a.a)(this.bbMin);for(let t=0;t<h;++t){const r=this._numIndexPerPrimitive*e[t];for(let e=0;e<this._numIndexPerPrimitive;++e){u=l*i[r+e],c.push(u);let t=n[u];this.bbMin[0]=Math.min(t,this.bbMin[0]),this.bbMax[0]=Math.max(t,this.bbMax[0]),t=n[u+1],this.bbMin[1]=Math.min(t,this.bbMin[1]),this.bbMax[1]=Math.max(t,this.bbMax[1]),t=n[u+2],this.bbMin[2]=Math.min(t,this.bbMin[2]),this.bbMax[2]=Math.max(t,this.bbMax[2])}}(0,s.e)(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let d=this.radius*this.radius;for(let e=0;e<c.length;++e){u=c.getItemAt(e);const t=n[u]-this.center[0],i=n[u+1]-this.center[1],r=n[u+2]-this.center[2],s=t*t+i*i+r*r;if(s<=d)continue;const a=Math.sqrt(s),o=.5*(a-this.radius);this.radius=this.radius+o,d=this.radius*this.radius;const l=o/a;this.center[0]+=t*l,this.center[1]+=i*l,this.center[2]+=r*l}c.clear()}getCenter(){return this.center}getBSRadius(){return this.radius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getChildren(){if(this._children)return this._children;if((0,s.h)(this.bbMin,this.bbMax)>1){const e=(0,s.e)((0,a.c)(),this.bbMin,this.bbMax,.5),t=this.primitiveIndices.length,i=new Uint8Array(t),r=new Array(8);for(let e=0;e<8;++e)r[e]=0;const{data:n,size:o}=this.position;for(let s=0;s<t;++s){let t=0;const a=this._numIndexPerPrimitive*this.primitiveIndices[s];let l=o*this.indices[a],c=n[l],h=n[l+1],u=n[l+2];for(let e=1;e<this._numIndexPerPrimitive;++e){l=o*this.indices[a+e];const t=n[l],i=n[l+1],r=n[l+2];t<c&&(c=t),i<h&&(h=i),r<u&&(u=r)}c<e[0]&&(t|=1),h<e[1]&&(t|=2),u<e[2]&&(t|=4),i[s]=t,++r[t]}let c=0;for(let e=0;e<8;++e)r[e]>0&&++c;if(c<2)return;const h=new Array(8);for(let e=0;e<8;++e)h[e]=r[e]>0?new Uint32Array(r[e]):void 0;for(let e=0;e<8;++e)r[e]=0;for(let e=0;e<t;++e){const t=i[e];h[t][r[t]++]=this.primitiveIndices[e]}this._children=new Array(8);for(let e=0;e<8;++e)void 0!==h[e]&&(this._children[e]=new l(h[e],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}static prune(){c.prune()}}const c=new n.Z({deallocator:null});var h=i(10107),u=i(51701);class d extends h.c{constructor(e,t=[],i=0,r=-1){super(),this._primitiveType=i,this.edgeIndicesLength=r,this.type=2,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[t,i]of e)i&&this._vertexAttributes.set(t,{...i});if(null==t||0===t.length){const e=function(e){const t=e.values().next().value;return null==t?0:t.data.length/t.size}(this._vertexAttributes),t=(0,u.p)(e);this.edgeIndicesLength=this.edgeIndicesLength<0?e:this.edgeIndicesLength;for(const e of this._vertexAttributes.keys())this._indices.set(e,t)}else for(const[e,i]of t)i&&(this._indices.set(e,f(i)),"position"===e&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(e).length:this.edgeIndicesLength))}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(e){const t=this._vertexAttributes.get(e);return t&&!t.exclusive&&(t.data=Array.from(t.data),t.exclusive=!0),t}get indices(){return this._indices}get indexCount(){const e=this._indices.values().next().value;return e?e.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return(0,r.Wi)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(e){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)}computeAttachmentOriginTriangles(e){const t=this.indices.get("position"),i=this.vertexAttributes.get("position");return(0,u.cM)(i,t,e)}computeAttachmentOriginPoints(e){const t=this.indices.get("position"),i=this.vertexAttributes.get("position");return(0,u.NO)(i,t,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.indices.get("position");if(0===e.length)return null;const t=0===this.primitiveType?3:1;(0,o.hu)(e.length%t==0,"Indexing error: "+e.length+" not divisible by "+t);const i=(0,u.p)(e.length/t),r=this.vertexAttributes.get("position");return new l(i,t,e,r)}}function f(e){if(e.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return e;for(const t of e)if(t>=65536)return e;return new Uint16Array(e)}},7358:(e,t,i)=>{i.d(t,{F:()=>o,z:()=>l});var r=i(61681),n=i(10107),s=i(5474),a=i(25584);class o extends n.c{constructor(e,t){super(),this.type=3,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=s.i,this._parameters=(0,a.Uf)(e,t),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(e){return!1}setParameters(e){(0,a.LO)(this._parameters,e)&&(this.validateParameters(this._parameters),this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleInPass(e.pass)&&0!=(this.renderOccluded&e.renderOccludedMask)}isVisibleInPass(e){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){(0,r.pC)(this.repository)&&this.repository.materialChanged(this)}}const l={renderOccluded:1}},12045:(e,t,i)=>{i.d(t,{$L:()=>o,$x:()=>d,Vc:()=>l,E0:()=>h,ve:()=>c,IB:()=>a,wu:()=>n,je:()=>u});var r=i(17346);const n=(0,r.wK)(770,1,771,771),s=(0,r.if)(1,1),a=(0,r.if)(0,771);function o(e){return 2===e?null:1===e?a:s}function l(e){return 2===e?r.LZ:null}const c=5e5,h={factor:-1,units:-2};function u(e){return e?h:null}function d(e){return 3===e||2===e?513:515}},95194:(e,t,i)=>{i.d(t,{$:()=>o});var r=i(61681),n=i(17135),s=i(6174),a=i(69002);class o extends a.${constructor(e,t,i){super(e,t.generateSource("vertex"),t.generateSource("fragment"),i),this._textures=new Map,this._freeTextureUnits=new n.Z({deallocator:null}),this._fragmentUniforms=(0,s.hZ)()?t.fragmentUniforms.entries:null}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(e,t){if((0,r.Wi)(e)||null==e.glName){const e=this._textures.get(t);return e&&(this._context.bindTexture(null,e.unit),this._freeTextureUnit(e),this._textures.delete(t)),null}let i=this._textures.get(t);return null==i?(i=this._allocTextureUnit(e),this._textures.set(t,i)):i.texture=e,this._context.useProgram(this),this.setUniform1i(t,i.unit),this._context.bindTexture(e,i.unit),i.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach(((e,t)=>{this._context.bindTexture(e.texture,e.unit),this.setUniform1i(t,e.unit)})),(0,r.pC)(this._fragmentUniforms)&&this._fragmentUniforms.forEach((e=>{if(("sampler2D"===e.type||"samplerCube"===e.type)&&!this._textures.has(e.name))throw new Error(`Texture sampler ${e.name} has no bound texture`)}))}_allocTextureUnit(e){return{texture:e,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(e){this._freeTextureUnits.push(e.unit)}}},79040:(e,t,i)=>{i.d(t,{zV:()=>n,JN:()=>r,RY:()=>o,eD:()=>l,ii:()=>c,YD:()=>h,P7:()=>a,s3:()=>s});const r={func:513},n={func:519},s={mask:255},a={mask:0},o={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},l={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},c={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},h={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},58496:(e,t,i)=>{i.d(t,{x:()=>E});var r=i(27755),n=i(70375),s=i(31355),a=i(19431),o=i(61681),l=i(78668),c=i(86098),h=i(3466),u=i(44883),d=i(73401),f=i(36567);let p;var m=i(43487),g=i(62486);let v=null,_=null;async function x(){return(0,o.Wi)(_)&&(_=function(){if((0,o.Wi)(p)){const e=e=>(0,f.V)(`esri/libs/basisu/${e}`);p=i.e(1681).then(i.bind(i,21681)).then((e=>e.b)).then((({default:t})=>t({locateFile:e}).then((e=>(e.initializeBasis(),delete e.then,e)))))}return p}(),v=await _),_}function b(e,t,i,r,n){const s=(0,g.RG)(t?37496:37492),a=n&&e>1?(4**e-1)/(3*4**(e-1)):1;return Math.ceil(i*r*s*a)}function T(e){return e.getNumImages()>=1&&!e.isUASTC()}function S(e){return e.getFaces()>=1&&e.isETC1S()}function w(e,t,i,r,n,s,a,o){const{compressedTextureETC:l,compressedTextureS3TC:c}=e.capabilities,[h,u]=l?r?[1,37496]:[0,37492]:c?r?[3,33779]:[2,33776]:[13,6408],d=t.hasMipmap?i:Math.min(1,i),f=[];for(let e=0;e<d;e++)f.push(new Uint8Array(a(e,h))),o(e,h,f[e]);const p=f.length>1,g=p?9987:9729,v={...t,samplingMode:g,hasMipmap:p,internalFormat:u,width:n,height:s};return new m.Z(e,v,{type:"compressed",levels:f})}var M=i(10107);const y=i(13802).Z.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil");function I(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const A=I("DXT1"),P=I("DXT3"),z=I("DXT5");function F(e,t){const i=new Int32Array(e,0,31);if(542327876!==i[0])return y.error("Invalid magic number in DDS header"),null;if(!(4&i[20]))return y.error("Unsupported format, must contain a FourCC code"),null;const r=i[21];let n,s;switch(r){case A:n=8,s=33776;break;case P:n=16,s=33778;break;case z:n=16,s=33779;break;default:return y.error("Unsupported FourCC code:",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(r)),null}let o=1,l=i[4],c=i[3];0==(3&l)&&0==(3&c)||(y.warn("Rounding up compressed texture size to nearest multiple of 4."),l=l+3&-4,c=c+3&-4);const h=l,u=c;let d,f;131072&i[2]&&!1!==t&&(o=Math.max(1,i[7])),1===o||(0,a.wt)(l)&&(0,a.wt)(c)||(y.warn("Ignoring mipmaps of non power of two sized compressed texture."),o=1);let p=i[1]+4;const m=[];for(let t=0;t<o;++t)f=(l+3>>2)*(c+3>>2)*n,d=new Uint8Array(e,p,f),m.push(d),p+=f,l=Math.max(1,l>>1),c=Math.max(1,c>>1);return{textureData:{type:"compressed",levels:m},internalFormat:s,width:h,height:u}}var C=i(63400),D=i(15095),O=i(18567),L=i(79193);class E extends M.c{constructor(e,t){super(),this.data=e,this.type=4,this._glTexture=null,this._powerOfTwoStretchInfo=null,this._loadingPromise=null,this._loadingController=null,this.events=new s.Z,this.params=t||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:10497,t:10497},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||1,this.estimatedTexMemRequired=E.estimateTexMemRequired(this.data,this.params),this.startPreload()}startPreload(){const e=this.data;(0,o.Wi)(e)||(e instanceof HTMLVideoElement?this.startPreloadVideoElement(e):e instanceof HTMLImageElement&&this.startPreloadImageElement(e))}startPreloadVideoElement(e){(0,h.jc)(e.src)||"auto"===e.preload&&e.crossOrigin||(e.preload="auto",e.crossOrigin="anonymous",e.src=e.src)}startPreloadImageElement(e){(0,h.HK)(e.src)||(0,h.jc)(e.src)||e.crossOrigin||(e.crossOrigin="anonymous",e.src=e.src)}static getDataDimensions(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}static estimateTexMemRequired(e,t){if((0,o.Wi)(e))return 0;if((0,c.eP)(e)||(0,c.lq)(e))return t.encoding===E.KTX2_ENCODING?function(e,t){if((0,o.Wi)(v))return e.byteLength;const i=new v.KTX2File(new Uint8Array(e)),r=S(i)?b(i.getLevels(),i.getHasAlpha(),i.getWidth(),i.getHeight(),t):0;return i.close(),i.delete(),r}(e,t.mipmap):t.encoding===E.BASIS_ENCODING?function(e,t){if((0,o.Wi)(v))return e.byteLength;const i=new v.BasisFile(new Uint8Array(e)),r=T(i)?b(i.getNumLevels(0),i.getHasAlpha(),i.getImageWidth(0,0),i.getImageHeight(0,0),t):0;return i.close(),i.delete(),r}(e,t.mipmap):e.byteLength;const{width:i,height:r}=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?E.getDataDimensions(e):t;return(t.mipmap?4/3:1)*i*r*(t.components||4)||0}dispose(){this.data=void 0}get width(){return this.params.width}get height(){return this.params.height}createDescriptor(e){var t;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(t=this.params.maxAnisotropy)?t:this.params.mipmap?e.parameters.maxMaxAnisotropy:1}}get glTexture(){return this._glTexture}load(e,t){if((0,o.pC)(this._glTexture))return this._glTexture;if((0,o.pC)(this._loadingPromise))return this._loadingPromise;const i=this.data;return(0,o.Wi)(i)?(this._glTexture=new m.Z(e,this.createDescriptor(e),null),this._glTexture):"string"==typeof i?this.loadFromURL(e,t,i):i instanceof Image?this.loadFromImageElement(e,t,i):i instanceof HTMLVideoElement?this.loadFromVideoElement(e,t,i):i instanceof ImageData||i instanceof HTMLCanvasElement?this.loadFromImage(e,i,t):((0,c.eP)(i)||(0,c.lq)(i))&&this.params.encoding===E.DDS_ENCODING?this.loadFromDDSData(e,i):((0,c.eP)(i)||(0,c.lq)(i))&&this.params.encoding===E.KTX2_ENCODING?this.loadFromKTX2(e,i):((0,c.eP)(i)||(0,c.lq)(i))&&this.params.encoding===E.BASIS_ENCODING?this.loadFromBasis(e,i):(0,c.lq)(i)?this.loadFromPixelData(e,i):(0,c.eP)(i)?this.loadFromPixelData(e,new Uint8Array(i)):null}get requiresFrameUpdates(){return this.data instanceof HTMLVideoElement}frameUpdate(e,t,i){if(!(this.data instanceof HTMLVideoElement)||(0,o.Wi)(this._glTexture))return i;if(this.data.readyState<2||i===this.data.currentTime)return i;if((0,o.pC)(this._powerOfTwoStretchInfo)){const{framebuffer:i,vao:r,sourceTexture:n}=this._powerOfTwoStretchInfo;n.setData(this.data),this.drawStretchedTexture(e,t,i,r,n,this._glTexture)}else{const{width:e,height:t}=this.data,{width:i,height:r}=this._glTexture.descriptor;e!==i||t!==r?this._glTexture.updateData(0,0,0,Math.min(e,i),Math.min(t,r),this.data):this._glTexture.setData(this.data)}return this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this.data.currentTime}loadFromDDSData(e,t){return this._glTexture=function(e,t,i){const{textureData:r,internalFormat:n,width:s,height:a}=F(i,t.hasMipmap);return t.samplingMode=r.levels.length>1?9987:9729,t.hasMipmap=r.levels.length>1,t.internalFormat=n,t.width=s,t.height=a,new m.Z(e,t,r)}(e,this.createDescriptor(e),t),this._glTexture}loadFromKTX2(e,t){return this.loadAsync((()=>async function(e,t,i){(0,o.Wi)(v)&&(v=await x());const r=new v.KTX2File(new Uint8Array(i));if(!S(r))return null;r.startTranscoding();const n=w(e,t,r.getLevels(),r.getHasAlpha(),r.getWidth(),r.getHeight(),((e,t)=>r.getImageTranscodedSizeInBytes(e,0,0,t)),((e,t,i)=>r.transcodeImage(i,e,0,0,t,0,-1,-1)));return r.close(),r.delete(),n}(e,this.createDescriptor(e),t).then((e=>(this._glTexture=e,e)))))}loadFromBasis(e,t){return this.loadAsync((()=>async function(e,t,i){(0,o.Wi)(v)&&(v=await x());const r=new v.BasisFile(new Uint8Array(i));if(!T(r))return null;r.startTranscoding();const n=w(e,t,r.getNumLevels(0),r.getHasAlpha(),r.getImageWidth(0,0),r.getImageHeight(0,0),((e,t)=>r.getImageTranscodedSizeInBytes(0,e,t)),((e,t,i)=>r.transcodeImage(i,0,e,t,0,0)));return r.close(),r.delete(),n}(e,this.createDescriptor(e),t).then((e=>(this._glTexture=e,e)))))}loadFromPixelData(e,t){(0,D.hu)(this.params.width>0&&this.params.height>0);const i=this.createDescriptor(e);return i.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,i.width=this.params.width,i.height=this.params.height,this._glTexture=new m.Z(e,i,t),this._glTexture}loadFromURL(e,t,i){return this.loadAsync((async r=>{const n=await(0,u.t)(i,{signal:r});return this.loadFromImage(e,n,t)}))}loadFromImageElement(e,t,i){return i.complete?this.loadFromImage(e,i,t):this.loadAsync((async r=>{const n=await(0,d.f)(i,i.src,!1,r);return this.loadFromImage(e,n,t)}))}loadFromVideoElement(e,t,i){return i.readyState>=2?this.loadFromImage(e,i,t):this.loadFromVideoElementAsync(e,t,i)}loadFromVideoElementAsync(e,t,i){return this.loadAsync((r=>new Promise(((s,a)=>{const c=()=>{i.removeEventListener("loadeddata",h),i.removeEventListener("error",u),(0,o.hw)(d)},h=()=>{i.readyState>=2&&(c(),s(this.loadFromImage(e,i,t)))},u=e=>{c(),a(e||new n.Z("Failed to load video"))};i.addEventListener("loadeddata",h),i.addEventListener("error",u);const d=(0,l.fu)(r,(()=>u((0,l.zE)())))}))))}loadFromImage(e,t,i){const r=E.getDataDimensions(t);this.params.width=r.width,this.params.height=r.height;const n=this.createDescriptor(e);return n.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(e,n)||(0,a.wt)(r.width)&&(0,a.wt)(r.height)?(n.width=r.width,n.height=r.height,this._glTexture=new m.Z(e,n,t),this._glTexture):(this._glTexture=this.makePowerOfTwoTexture(e,t,r,n,i),this._glTexture)}loadAsync(e){const t=new AbortController;this._loadingController=t;const i=e(t.signal);this._loadingPromise=i;const r=()=>{this._loadingController===t&&(this._loadingController=null),this._loadingPromise===i&&(this._loadingPromise=null)};return i.then(r,r),i}requiresPowerOfTwo(e,t){const i=33071,r="number"==typeof t.wrapMode?t.wrapMode===i:t.wrapMode.s===i&&t.wrapMode.t===i;return!(0,L.Z)(e.gl)&&(t.hasMipmap||!r)}makePowerOfTwoTexture(e,t,i,n,s){const{width:o,height:l}=i,c=(0,a.Sf)(o),h=(0,a.Sf)(l);let u;switch(n.width=c,n.height=h,this.params.powerOfTwoResizeMode){case 2:n.textureCoordinateScaleFactor=[o/c,l/h],u=new m.Z(e,n),u.updateData(0,0,0,o,l,t);break;case 1:case null:case void 0:u=this.stretchToPowerOfTwo(e,t,n,s());break;default:(0,r.Bg)(this.params.powerOfTwoResizeMode)}return n.hasMipmap&&u.generateMipmap(),u}stretchToPowerOfTwo(e,t,i,r){const n=new m.Z(e,i),s=new O.Z(e,{colorTarget:0,depthStencilTarget:0},n),a=new m.Z(e,{target:3553,pixelFormat:i.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!i.flipped,maxAnisotropy:8,preMultiplyAlpha:i.preMultiplyAlpha},t),o=(0,C.ow)(e),l=e.getBoundFramebufferObject();return this.drawStretchedTexture(e,r,s,o,a,n),this.requiresFrameUpdates?this._powerOfTwoStretchInfo={vao:o,sourceTexture:a,framebuffer:s}:(o.dispose(!0),a.dispose(),s.detachColorTexture(),s.dispose()),e.bindFramebuffer(l),n}drawStretchedTexture(e,t,i,r,n,s){e.bindFramebuffer(i);const a=e.getViewport();e.setViewport(0,0,s.descriptor.width,s.descriptor.height);const o=t.program;e.useProgram(o),o.setUniform4f("color",1,1,1,1),o.bindTexture(n,"tex"),e.bindVAO(r),t.bindPipelineState(e),e.drawArrays(5,0,(0,g._V)(r,"geometry")),e.bindFramebuffer(null),e.setViewport(a.x,a.y,a.width,a.height)}unload(){if((0,o.pC)(this._powerOfTwoStretchInfo)){const{framebuffer:e,vao:t,sourceTexture:i}=this._powerOfTwoStretchInfo;t.dispose(!0),i.dispose(),e.dispose(),this._glTexture=null,this._powerOfTwoStretchInfo=null}if((0,o.pC)(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),(0,o.pC)(this._loadingController)){const e=this._loadingController;this._loadingController=null,this._loadingPromise=null,e.abort()}this.events.emit("unloaded")}}E.DDS_ENCODING="image/vnd-ms.dds",E.KTX2_ENCODING="image/ktx2",E.BASIS_ENCODING="image/x.basis"},15095:(e,t,i)=>{i.d(t,{hu:()=>s,tM:()=>u,RQ:()=>d,Kj:()=>c,zF:()=>h,Xv:()=>f,kG:()=>l,yK:()=>a,u_:()=>o}),i(19431),i(24455);var r=i(55709);i(69666),i(8909),i(88589),(0,i(1983).c)();class n{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}}function s(e,t){if(!e){t=t||"assert";const e=new Error(t);throw e.stack&&console.log(e.stack),new n(t)}}function a(e,t,i,r){let n,s=(i[0]-e[0])/t[0],a=(r[0]-e[0])/t[0];s>a&&(n=s,s=a,a=n);let o=(i[1]-e[1])/t[1],l=(r[1]-e[1])/t[1];if(o>l&&(n=o,o=l,l=n),s>l||o>a)return!1;o>s&&(s=o),l<a&&(a=l);let c=(i[2]-e[2])/t[2],h=(r[2]-e[2])/t[2];return c>h&&(n=c,c=h,h=n),!(s>h||c>a||(h<a&&(a=h),a<0))}function o(e,t,i,r){e[12]=t,e[13]=i,e[14]=r}function l(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}function c(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)}function h(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)}function u(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}function d(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}function f(e,t,i,n,s){const a=e;0===e[11]?(n[0]=2/(t*a[0]),n[1]=2/(i*a[5]),n[2]=(1+a[12])/a[0],n[3]=(1+a[13])/a[5],(0,r.s)(s,0,1)):(n[0]=-2/(t*a[0]),n[1]=-2/(i*a[5]),n[2]=(1-a[8])/a[0],n[3]=(1-a[9])/a[5],(0,r.s)(s,1,0))}},51701:(e,t,i)=>{i.d(t,{qZ:()=>g,NO:()=>m,cM:()=>p,p:()=>d,DX:()=>f});var r=i(6766),n=i(8909),s=i(19480),a=(i(55709),i(56215));i(68817),new s.x(a.Ue),new s.x((()=>({p0:null,p1:null,p2:null})));const o=(0,n.c)(),l=(0,n.c)();let c=(()=>{const e=new Uint32Array(131072);for(let t=0;t<e.length;++t)e[t]=t;return e})();const h=new Uint16Array([0]),u=(()=>{const e=new Uint16Array(65536);for(let t=0;t<e.length;++t)e[t]=t;return e})();function d(e){if(1===e)return h;if(e<u.length)return new Uint16Array(u.buffer,0,e);if(e>c.length){const t=Math.max(2*c.length,e);c=new Uint32Array(t);for(let e=0;e<c.length;e++)c[e]=e}return new Uint32Array(c.buffer,0,e)}function f(e){if(1===e)return new Uint16Array(h);if(e<u.length)return new Uint16Array(u.slice(0,e));if(e>c.length){const t=new Uint32Array(e);for(let e=0;e<t.length;e++)t[e]=e;return t}return new Uint32Array(c.slice(0,e))}function p(e,t,i){if(!e)return!1;const{size:n,data:s}=e;(0,r.s)(i,0,0,0),(0,r.s)(b,0,0,0);let a=0,c=0;for(let e=0;e<t.length-2;e+=3){const f=t[e+0]*n,p=t[e+1]*n,m=t[e+2]*n;(0,r.s)(v,s[f+0],s[f+1],s[f+2]),(0,r.s)(_,s[p+0],s[p+1],s[p+2]),(0,r.s)(x,s[m+0],s[m+1],s[m+2]);const g=(h=v,u=_,d=x,(0,r.f)(o,u,h),(0,r.f)(l,d,h),(0,r.l)((0,r.c)(o,o,l))/2);g?((0,r.b)(v,v,_),(0,r.b)(v,v,x),(0,r.a)(v,v,1/3*g),(0,r.b)(i,i,v),a+=g):((0,r.b)(b,b,v),(0,r.b)(b,b,_),(0,r.b)(b,b,x),c+=3)}var h,u,d;return!(0===c&&0===a||(0!==a?((0,r.a)(i,i,1/a),0):0===c||((0,r.a)(i,b,1/c),0)))}function m(e,t,i){if(!e||!t)return!1;const{size:n,data:s}=e;(0,r.s)(i,0,0,0);let a=-1,o=0;for(let e=0;e<t.length;e++){const r=t[e]*n;a!==r&&(i[0]+=s[r+0],i[1]+=s[r+1],i[2]+=s[r+2],o++),a=r}return o>1&&(0,r.a)(i,i,1/o),o>0}function g(e,t,i,n){if(!e)return!1;const{size:s,data:a}=e;(0,r.s)(n,0,0,0),(0,r.s)(b,0,0,0);let o=0,l=0;const c=t?t.length-1:a.length/s-1,h=c+(i?2:0);for(let e=0;e<h;e+=2){const i=e<c?e:c,h=e<c?e+1:0,u=(t?t[i]:i)*s,d=(t?t[h]:h)*s;v[0]=a[u+0],v[1]=a[u+1],v[2]=a[u+2],_[0]=a[d+0],_[1]=a[d+1],_[2]=a[d+2],(0,r.a)(v,(0,r.b)(v,v,_),.5);const f=(0,r.j)(v,_);f>0?((0,r.b)(n,n,(0,r.a)(v,v,f)),o+=f):((0,r.b)(b,b,v),l++)}return 0!==o?((0,r.a)(n,n,1/o),!0):0!==l&&((0,r.a)(n,b,1/l),!0)}const v=(0,n.c)(),_=(0,n.c)(),x=(0,n.c)(),b=(0,n.c)()},63400:(e,t,i)=>{i.d(t,{hf:()=>h,ow:()=>c});var r=i(5474);const n=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],s=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];var a=i(78951),o=i(43487),l=i(29620);function c(e,t=n,i=r.i,o=-1,c=1){let h=null;return h=t===s?new Float32Array([o,o,0,0,c,o,1,0,o,c,0,1,c,c,1,1]):new Float32Array([o,o,c,o,o,c,c,c]),new l.Z(e,i,{geometry:t},{geometry:a.Z.createVertex(e,35044,h)})}function h(e){return new o.Z(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},72946:(e,t,i)=>{i.d(t,{TU:()=>l,sX:()=>a,PV:()=>o,bA:()=>c});var r=i(19431);function n(e,t,i){const r=i.parameters,n=i.paddingPixelsOverride;return h.scale=Math.min(r.divisor/(t-r.offset),1),h.factor=function(e){return Math.abs(e*e*e)}(e),h.minPixelSize=r.minPixelSize,h.paddingPixels=n,h}function s(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function a(e,t){return Math.max((0,r.t7)(e*t.scale,e,t.factor),s(e,t))}function o(e,t,i,r){r.scale=function(e,t,i){const r=n(e,t,i);return r.minPixelSize=0,r.paddingPixels=0,a(1,r)}(e,t,i),r.factor=0,r.minPixelSize=i.parameters.minPixelSize,r.paddingPixels=i.paddingPixelsOverride}function l(e,t,i=[0,0]){const r=Math.min(Math.max(t.scale,s(e[1],t)/e[1]),1);return i[0]=e[0]*r,i[1]=e[1]*r,i}function c(e,t,i,r){return a(e,n(t,i,r))}(0,r.Vl)(10),(0,r.Vl)(12),(0,r.Vl)(70),(0,r.Vl)(40);const h={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},5073:(e,t,i)=>{i.d(t,{yn:()=>m,W9:()=>_});var r=i(61681),n=i(1662),s=i(34344),a=i(24455),o=i(39100),l=i(10663),c=i(61044),h=i(6766),u=i(79912),d=i(8909),f=i(1983),p=i(91917);class m{constructor(){this._transform=(0,o.c)(),this._transformInverse=new g({value:this._transform},a.b,o.c),this._transformInverseTranspose=new g(this._transformInverse,a.t,o.c),this._transformTranspose=new g({value:this._transform},a.t,o.c),this._transformInverseRotation=new g({value:this._transform},n.n,s.c)}invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){(0,a.c)(this._transform,e)}multiplyTransform(e){(0,a.m)(this._transform,this._transform,e)}set(e){(0,a.c)(this._transform,e),this.invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}class g{constructor(e,t,i){this.original=e,this.update=t,this.dirty=!0,this.transform=i()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}const v=new class{constructor(e=0){this.offset=e,this.sphere=(0,p.c)(),this.tmpVertex=(0,d.c)()}applyToVertex(e,t,i){const r=this.objectTransform.transform;let n=r[0]*e+r[4]*t+r[8]*i+r[12],s=r[1]*e+r[5]*t+r[9]*i+r[13],a=r[2]*e+r[6]*t+r[10]*i+r[14];const o=this.offset/Math.sqrt(n*n+s*s+a*a);n+=n*o,s+=s*o,a+=a*o;const l=this.objectTransform.inverse;return this.tmpVertex[0]=l[0]*n+l[4]*s+l[8]*a+l[12],this.tmpVertex[1]=l[1]*n+l[5]*s+l[9]*a+l[13],this.tmpVertex[2]=l[2]*n+l[6]*s+l[10]*a+l[14],this.tmpVertex}applyToMinMax(e,t){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r}applyToAabb(e){const t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;const i=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*i,e[4]+=e[4]*i,e[5]+=e[5]*i,e}applyToBoundingSphere(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.sphere[0]=e[0]+e[0]*i,this.sphere[1]=e[1]+e[1]*i,this.sphere[2]=e[2]+e[2]*i,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}};function _(e){return(0,r.pC)(e)?(v.offset=e,v):null}new class{constructor(e=0){this.offset=e,this.componentLocalOriginLength=0,this.tmpVertex=(0,d.c)(),this.mbs=(0,f.c)(),this.obb={center:(0,d.c)(),halfSize:(0,u.c)(),quaternion:null}}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,t,i){const r=e,n=t,s=i+this.componentLocalOriginLength,a=this.offset/Math.sqrt(r*r+n*n+s*s);return this.tmpVertex[0]=e+r*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=i+s*a,this.tmpVertex}applyToAabb(e){const t=e[0],i=e[1],r=e[2]+this.componentLocalOriginLength,n=e[3],s=e[4],a=e[5]+this.componentLocalOriginLength,o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;const l=this.offset/Math.sqrt(n*n+s*s+a*a);return e[3]+=n*l,e[4]+=s*l,e[5]+=a*l,e}applyToMbs(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.mbs[0]=e[0]+e[0]*i,this.mbs[1]=e[1]+e[1]*i,this.mbs[2]=e[2]+e[2]*i,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}applyToObb(e){const t=e.center,i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*i,this.obb.center[1]=t[1]+t[1]*i,this.obb.center[2]=t[2]+t[2]*i,(0,h.q)(this.obb.halfSize,e.halfSize,e.quaternion),(0,h.b)(this.obb.halfSize,this.obb.halfSize,e.center);const r=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*r,this.obb.halfSize[1]+=this.obb.halfSize[1]*r,this.obb.halfSize[2]+=this.obb.halfSize[2]*r,(0,h.f)(this.obb.halfSize,this.obb.halfSize,e.center),(0,l.c)(x,e.quaternion),(0,h.q)(this.obb.halfSize,this.obb.halfSize,x),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}},new class{constructor(e=0){this.offset=e,this.tmpVertex=(0,d.c)()}applyToVertex(e,t,i){const r=e+this.localOrigin[0],n=t+this.localOrigin[1],s=i+this.localOrigin[2],a=this.offset/Math.sqrt(r*r+n*n+s*s);return this.tmpVertex[0]=e+r*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=i+s*a,this.tmpVertex}applyToAabb(e){const t=e[0]+this.localOrigin[0],i=e[1]+this.localOrigin[1],r=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],s=e[4]+this.localOrigin[1],a=e[5]+this.localOrigin[2],o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;const l=this.offset/Math.sqrt(n*n+s*s+a*a);return e[3]+=n*l,e[4]+=s*l,e[5]+=a*l,e}};const x=(0,c.a)()},25584:(e,t,i)=>{i.d(t,{bj:()=>S,FZ:()=>A,Uf:()=>w,Tw:()=>b,TT:()=>y,Bw:()=>d,CN:()=>g,LO:()=>M,Hx:()=>T});var r=i(19431),n=i(61681),s=i(6766),a=i(8909),o=i(37116),l=i(72946),c=i(15095),h=i(73622);const u=(0,o.Ue)();function d(e,t,i,r,n,s,a){if(!(0,h.PD)(t))if(e.boundingInfo){(0,c.hu)(0===e.primitiveType);const t=i.tolerance;p(e.boundingInfo,r,n,t,s,a)}else{const t=e.indices.get("position"),i=e.vertexAttributes.get("position");g(r,n,0,t.length/3,t,i,void 0,s,a)}}const f=(0,a.c)();function p(e,t,i,r,a,l){if((0,n.Wi)(e))return;const c=function(e,t,i){return(0,s.s)(i,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}(t,i,f);if((0,o.op)(u,e.getBBMin()),(0,o.Tn)(u,e.getBBMax()),(0,n.pC)(a)&&a.applyToAabb(u),b(u,t,c,r)){const{primitiveIndices:n,indices:s,position:o}=e,c=n?n.length:s.length/3;if(c>P){const n=e.getChildren();if(void 0!==n){for(let e=0;e<8;++e)void 0!==n[e]&&p(n[e],t,i,r,a,l);return}}g(t,i,0,c,s,o,n,a,l)}}const m=(0,a.c)();function g(e,t,i,r,s,a,o,l,c){if(o)return function(e,t,i,r,s,a,o,l,c){const h=a.data,u=a.stride||a.size,d=e[0],f=e[1],p=e[2],g=t[0]-d,v=t[1]-f,_=t[2]-p;for(let e=i;e<r;++e){const t=o[e];let i=3*t,r=u*s[i++],a=h[r++],b=h[r++],T=h[r];r=u*s[i++];let S=h[r++],w=h[r++],M=h[r];r=u*s[i];let y=h[r++],I=h[r++],A=h[r];(0,n.pC)(l)&&([a,b,T]=l.applyToVertex(a,b,T,e),[S,w,M]=l.applyToVertex(S,w,M,e),[y,I,A]=l.applyToVertex(y,I,A,e));const P=S-a,z=w-b,F=M-T,C=y-a,D=I-b,O=A-T,L=v*O-D*_,E=_*C-O*g,H=g*D-C*v,N=P*L+z*E+F*H;if(Math.abs(N)<=Number.EPSILON)continue;const R=d-a,U=f-b,W=p-T,V=R*L+U*E+W*H;if(N>0){if(V<0||V>N)continue}else if(V>0||V<N)continue;const B=U*F-z*W,k=W*P-F*R,G=R*z-P*U,q=g*B+v*k+_*G;if(N>0){if(q<0||V+q>N)continue}else if(q>0||V+q<N)continue;const $=(C*B+D*k+O*G)/N;$>=0&&c($,x(P,z,F,C,D,O,m),t,!1)}}(e,t,i,r,s,a,o,l,c);const h=a.data,u=a.stride||a.size,d=e[0],f=e[1],p=e[2],g=t[0]-d,v=t[1]-f,_=t[2]-p;for(let e=i,t=3*i;e<r;++e){let i=u*s[t++],r=h[i++],a=h[i++],o=h[i];i=u*s[t++];let b=h[i++],T=h[i++],S=h[i];i=u*s[t++];let w=h[i++],M=h[i++],y=h[i];(0,n.pC)(l)&&([r,a,o]=l.applyToVertex(r,a,o,e),[b,T,S]=l.applyToVertex(b,T,S,e),[w,M,y]=l.applyToVertex(w,M,y,e));const I=b-r,A=T-a,P=S-o,z=w-r,F=M-a,C=y-o,D=v*C-F*_,O=_*z-C*g,L=g*F-z*v,E=I*D+A*O+P*L;if(Math.abs(E)<=Number.EPSILON)continue;const H=d-r,N=f-a,R=p-o,U=H*D+N*O+R*L;if(E>0){if(U<0||U>E)continue}else if(U>0||U<E)continue;const W=N*P-A*R,V=R*I-P*H,B=H*A-I*N,k=g*W+v*V+_*B;if(E>0){if(k<0||U+k>E)continue}else if(k>0||U+k<E)continue;const G=(z*W+F*V+C*B)/E;G>=0&&c(G,x(I,A,P,z,F,C,m),e,!1)}}const v=(0,a.c)(),_=(0,a.c)();function x(e,t,i,r,n,a,o){return(0,s.s)(v,e,t,i),(0,s.s)(_,r,n,a),(0,s.c)(o,v,_),(0,s.n)(o,o),o}function b(e,t,i,r){return function(e,t,i,r,n){const s=(e[0]-r-t[0])*i[0],a=(e[3]+r-t[0])*i[0];let o=Math.min(s,a),l=Math.max(s,a);const c=(e[1]-r-t[1])*i[1],h=(e[4]+r-t[1])*i[1];if(l=Math.min(l,Math.max(c,h)),l<0)return!1;if(o=Math.max(o,Math.min(c,h)),o>l)return!1;const u=(e[2]-r-t[2])*i[2],d=(e[5]+r-t[2])*i[2];return l=Math.min(l,Math.max(u,d)),!(l<0)&&(o=Math.max(o,Math.min(u,d)),!(o>l)&&o<1/0)}(e,t,i,r)}function T(e,t,i,n,s){let a=(i.screenLength||0)*e.pixelRatio;s&&(a=(0,l.bA)(a,n,t,s));const o=a*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return(0,r.uZ)(o*t,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function S(e,t,i){if(!e)return;const r=e.parameters,n=e.paddingPixelsOverride;t.setUniform4f(i,r.divisor,r.offset,r.minPixelSize,n)}function w(e,t){const i=t?w(t):{};for(const t in e){let r=e[t];r&&r.forEach&&(r=I(r)),null==r&&t in i||(i[t]=r)}return i}function M(e,t){let i=!1;for(const r in t){const n=t[r];void 0!==n&&(i=!0,Array.isArray(n)?e[r]=n.slice():e[r]=n)}return i}function y(e,t,i,n,s,a){if(!t.options.selectionMode)return;const o=e.vertexAttributes.get("position").data,l=e.vertexAttributes.get("size"),c=l&&l.data[0],h=n[0],u=n[1],d=((c+s)/2+4)*e.screenToWorldRatio;let f=Number.MAX_VALUE,p=0;for(let e=0;e<o.length-5;e+=3){const t=o[e],i=o[e+1],n=h-t,s=u-i,a=o[e+3]-t,l=o[e+4]-i,c=(0,r.uZ)((a*n+l*s)/(a*a+l*l),0,1),d=a*c-n,m=l*c-s,g=d*d+m*m;g<f&&(f=g,p=e/3)}f<d*d&&a(i.dist,i.normal,p,!1)}function I(e){const t=[];return e.forEach((e=>t.push(e))),t}const A={multiply:1,ignore:2,replace:3,tint:4},P=1e3},21123:(e,t,i)=>{i.d(t,{SW:()=>l,Vs:()=>d,NK:()=>f,s5:()=>h,ho:()=>c});var r=i(24455),n=i(81936),s=i(15095);function a(e,t,i,r){const n=i.typedBuffer,s=i.typedBufferStride,a=e.length;r*=s;for(let i=0;i<a;++i){const a=2*e[i];n[r]=t[a],n[r+1]=t[a+1],r+=s}}function o(e,t,i,r,n){const s=i.typedBuffer,a=i.typedBufferStride,o=e.length;if(r*=a,null==n||1===n)for(let i=0;i<o;++i){const n=3*e[i];s[r]=t[n],s[r+1]=t[n+1],s[r+2]=t[n+2],r+=a}else for(let i=0;i<o;++i){const o=3*e[i];for(let e=0;e<n;++e)s[r]=t[o],s[r+1]=t[o+1],s[r+2]=t[o+2],r+=a}}function l(e,t,i,r,n=1){const s=i.typedBuffer,a=i.typedBufferStride,o=e.length;if(r*=a,1===n)for(let i=0;i<o;++i){const n=4*e[i];s[r]=t[n],s[r+1]=t[n+1],s[r+2]=t[n+2],s[r+3]=t[n+3],r+=a}else for(let i=0;i<o;++i){const o=4*e[i];for(let e=0;e<n;++e)s[r]=t[o],s[r+1]=t[o+1],s[r+2]=t[o+2],s[r+3]=t[o+3],r+=a}}function c(e,t,i,r,n,s=1){if(!i)return void o(e,t,r,n,s);const a=r.typedBuffer,l=r.typedBufferStride,c=e.length,h=i[0],u=i[1],d=i[2],f=i[4],p=i[5],m=i[6],g=i[8],v=i[9],_=i[10],x=i[12],b=i[13],T=i[14];if(n*=l,1===s)for(let i=0;i<c;++i){const r=3*e[i],s=t[r],o=t[r+1],c=t[r+2];a[n]=h*s+f*o+g*c+x,a[n+1]=u*s+p*o+v*c+b,a[n+2]=d*s+m*o+_*c+T,n+=l}else for(let i=0;i<c;++i){const r=3*e[i],o=t[r],c=t[r+1],S=t[r+2],w=h*o+f*c+g*S+x,M=u*o+p*c+v*S+b,y=d*o+m*c+_*S+T;for(let e=0;e<s;++e)a[n]=w,a[n+1]=M,a[n+2]=y,n+=l}}function h(e,t,i,n,s,a=1){if(!i)return void o(e,t,n,s,a);const l=i,c=n.typedBuffer,h=n.typedBufferStride,u=e.length,d=l[0],f=l[1],p=l[2],m=l[4],g=l[5],v=l[6],_=l[8],x=l[9],b=l[10],T=!(0,r.k)(l),S=1e-6,w=1-S;if(s*=h,1===a)for(let i=0;i<u;++i){const r=3*e[i],n=t[r],a=t[r+1],o=t[r+2];let l=d*n+m*a+_*o,u=f*n+g*a+x*o,M=p*n+v*a+b*o;if(T){const e=l*l+u*u+M*M;if(e<w&&e>S){const t=1/Math.sqrt(e);l*=t,u*=t,M*=t}}c[s+0]=l,c[s+1]=u,c[s+2]=M,s+=h}else for(let i=0;i<u;++i){const r=3*e[i],n=t[r],o=t[r+1],l=t[r+2];let u=d*n+m*o+_*l,M=f*n+g*o+x*l,y=p*n+v*o+b*l;if(T){const e=u*u+M*M+y*y;if(e<w&&e>S){const t=1/Math.sqrt(e);u*=t,M*=t,y*=t}}for(let e=0;e<a;++e)c[s+0]=u,c[s+1]=M,c[s+2]=y,s+=h}}function u(e,t,i,n,s,a=1){if(!i)return void l(e,t,n,s,a);const o=i,c=n.typedBuffer,h=n.typedBufferStride,u=e.length,d=o[0],f=o[1],p=o[2],m=o[4],g=o[5],v=o[6],_=o[8],x=o[9],b=o[10],T=!(0,r.k)(o),S=1e-6,w=1-S;if(s*=h,1===a)for(let i=0;i<u;++i){const r=4*e[i],n=t[r],a=t[r+1],o=t[r+2],l=t[r+3];let u=d*n+m*a+_*o,M=f*n+g*a+x*o,y=p*n+v*a+b*o;if(T){const e=u*u+M*M+y*y;if(e<w&&e>S){const t=1/Math.sqrt(e);u*=t,M*=t,y*=t}}c[s+0]=u,c[s+1]=M,c[s+2]=y,c[s+3]=l,s+=h}else for(let i=0;i<u;++i){const r=4*e[i],n=t[r],o=t[r+1],l=t[r+2],u=t[r+3];let M=d*n+m*o+_*l,y=f*n+g*o+x*l,I=p*n+v*o+b*l;if(T){const e=M*M+y*y+I*I;if(e<w&&e>S){const t=1/Math.sqrt(e);M*=t,y*=t,I*=t}}for(let e=0;e<a;++e)c[s+0]=M,c[s+1]=y,c[s+2]=I,c[s+3]=u,s+=h}}function d(e,t,i,r,n,s=1){const a=r.typedBuffer,o=r.typedBufferStride,l=e.length;if(n*=o,1===s){if(4===i)for(let i=0;i<l;++i){const r=4*e[i];a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=t[r+3],n+=o}else if(3===i)for(let i=0;i<l;++i){const r=3*e[i];a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=255,n+=o}}else if(4===i)for(let i=0;i<l;++i){const r=4*e[i];for(let e=0;e<s;++e)a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=t[r+3],n+=o}else if(3===i)for(let i=0;i<l;++i){const r=3*e[i];for(let e=0;e<s;++e)a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=255,n+=o}}function f(e,t,i,r,o,l){for(const f of t.fieldNames){const t=e.vertexAttributes.get(f),p=e.indices.get(f);if(t&&p)switch(f){case"position":{(0,s.hu)(3===t.size);const e=o.getField(f,n.ct);e&&c(p,t.data,i,e,l);break}case"normal":{(0,s.hu)(3===t.size);const e=o.getField(f,n.ct);e&&h(p,t.data,r,e,l);break}case"uv0":{(0,s.hu)(2===t.size);const e=o.getField(f,n.Eu);e&&a(p,t.data,e,l);break}case"color":{(0,s.hu)(3===t.size||4===t.size);const e=o.getField(f,n.mc);e&&d(p,t.data,t.size,e,l);break}case"symbolColor":{(0,s.hu)(3===t.size||4===t.size);const e=o.getField(f,n.mc);e&&d(p,t.data,t.size,e,l);break}case"tangent":{(0,s.hu)(4===t.size);const e=o.getField(f,n.ek);e&&u(p,t.data,r,e,l);break}}}}},73622:(e,t,i)=>{i.d(t,{lr:()=>l,bZ:()=>u,EE:()=>d,PD:()=>h,U_:()=>c});var r=i(61681),n=i(24455),s=i(39100),a=i(15095),o=i(30560);function l(e,t){return(0,r.Wi)(e)&&(e=[]),e.push(t),e}function c(e,t){if((0,r.Wi)(e))return null;const i=e.filter((e=>e!==t));return 0===i.length?null:i}function h(e){return!!(0,r.pC)(e)&&!e.visible}function u(e,t,i){const s=e.origin.vec3;(0,a.u_)(m,-s[0],-s[1],-s[2]),(0,r.pC)(e.transformation)?(0,n.m)(t,m,e.transformation):(0,n.c)(t,m),i&&((0,n.b)(i,t),(0,n.t)(i,i))}function d(e,t,i,r,n){f[0]=e.get(t,0),f[1]=e.get(t,1),f[2]=e.get(t,2),(0,o.LF)(f,p,3),i.set(n,0,p[0]),r.set(n,0,p[1]),i.set(n,1,p[2]),r.set(n,1,p[3]),i.set(n,2,p[4]),r.set(n,2,p[5])}const f=new Float64Array(3),p=new Float32Array(6),m=(0,s.c)()},43487:(e,t,i)=>{i.d(t,{Z:()=>l});var r=i(19431),n=i(61681),s=i(6174),a=i(91907),o=i(79193);class l{constructor(e,t,i=null){this._context=e,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,e.instanceCounter.increment(a._g.Texture,this),this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...t},34067===this._descriptor.target?this.setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(a._g.Texture,this))}release(){this.dispose()}resize(e,t){const i=this._descriptor;i.width===e&&i.height===t||(i.width=e,i.height=t,34067===this._descriptor.target?this.setDataCubeMap(null):this.setData(null))}setDataCubeMap(e=null){for(let t=34069;t<=34074;t++)this.setData(e,t)}setData(e,t=3553){if(!this._context||!this._context.gl)return;const i=this._context.gl;this._glName||(this._glName=i.createTexture()),void 0===e&&(e=null),null===e&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);const r=this._context.bindTexture(this,l.TEXTURE_UNIT_FOR_UPDATES),a=this._descriptor;l._validateTexture(this._context,a),i.pixelStorei(i.UNPACK_ALIGNMENT,a.unpackAlignment),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,a.flipped?1:0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.preMultiplyAlpha?1:0);const o=a.pixelFormat;let c=a.internalFormat?a.internalFormat:this._deriveInternalFormat(o,a.dataType);if(e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){let r=e.width,n=e.height;e instanceof HTMLVideoElement&&(r=e.videoWidth,n=e.videoHeight),a.width&&a.height,i.texImage2D(t,0,c,o,a.dataType,e),(0,s.zu)(i),a.hasMipmap&&this.generateMipmap(),void 0===a.width&&(a.width=r),void 0===a.height&&(a.height=n)}else{null!=a.width&&null!=a.height||console.error("Width and height must be specified!"),i.DEPTH24_STENCIL8&&c===i.DEPTH_STENCIL&&(c=i.DEPTH24_STENCIL8);let r=a.width,l=a.height;if(function(e){return(0,n.pC)(e)&&"type"in e&&"compressed"===e.type}(e)){const n=Math.round(Math.log(Math.max(r,l))/Math.LN2)+1;a.hasMipmap=a.hasMipmap&&n===e.levels.length;for(let n=0;;++n){const s=e.levels[Math.min(n,e.levels.length-1)];if(i.compressedTexImage2D(t,n,c,r,l,0,s),1===r&&1===l||!a.hasMipmap)break;r=Math.max(1,r>>1),l=Math.max(1,l>>1)}}else if((0,n.pC)(e))i.texImage2D(t,0,c,r,l,0,o,a.dataType,e),(0,s.zu)(i),a.hasMipmap&&this.generateMipmap();else for(let e=0;i.texImage2D(t,e,c,r,l,0,o,a.dataType,null),(0,s.zu)(i),(1!==r||1!==l)&&a.hasMipmap;++e)r=Math.max(1,r>>1),l=Math.max(1,l>>1)}l._applySamplingMode(i,this._descriptor),l._applyWrapMode(i,this._descriptor),l._applyAnisotropicFilteringParameters(this._context,this._descriptor),(0,s.zu)(i),this._context.bindTexture(r,l.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,t,i,r,n,s,a=3553){s||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const o=this._context.gl,c=this._descriptor,h=this._context.bindTexture(this,l.TEXTURE_UNIT_FOR_UPDATES);(t<0||i<0||r>c.width||n>c.height||t+r>c.width||i+n>c.height)&&console.error("An attempt to update out of bounds of the texture!"),o.pixelStorei(o.UNPACK_ALIGNMENT,c.unpackAlignment),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?1:0),s instanceof ImageData||s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement?o.texSubImage2D(a,e,t,i,c.pixelFormat,c.dataType,s):o.texSubImage2D(a,e,t,i,r,n,c.pixelFormat,c.dataType,s),this._context.bindTexture(h,l.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;e.hasMipmap||(e.hasMipmap=!0,this._samplingModeDirty=!0,l._validateTexture(this._context,e)),9729===e.samplingMode?(this._samplingModeDirty=!0,e.samplingMode=9985):9728===e.samplingMode&&(this._samplingModeDirty=!0,e.samplingMode=9984);const t=this._context.bindTexture(this,l.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(e.target),this._context.bindTexture(t,l.TEXTURE_UNIT_FOR_UPDATES)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,l._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const e=this._context.gl,t=this._descriptor;this._samplingModeDirty&&(l._applySamplingMode(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(l._applyWrapMode(e,t),this._wrapModeDirty=!1)}_deriveInternalFormat(e,t){if("webgl"===this._context.webglVersion)return e;if(5126===t)switch(e){case 6408:return 34836;case 6407:return 34837;default:throw new Error("Unable to derive format")}return e}static _validateTexture(e,t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!");const i=(0,r.wt)(t.width)&&(0,r.wt)(t.height);(0,o.Z)(e.gl)||i||("number"==typeof t.wrapMode?33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===t.wrapMode.s&&33071===t.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}static _applySamplingMode(e,t){let i=t.samplingMode,r=t.samplingMode;9985===i||9987===i?(i=9729,t.hasMipmap||(r=9729)):9984!==i&&9986!==i||(i=9728,t.hasMipmap||(r=9728)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,i),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,r)}static _applyWrapMode(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}static _applyAnisotropicFilteringParameters(e,t){var i;const r=e.capabilities.textureFilterAnisotropic;r&&e.gl.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY,null!=(i=t.maxAnisotropy)?i:1)}}l.TEXTURE_UNIT_FOR_UPDATES=0},79193:(e,t,i)=>{function r(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}i.d(t,{Z:()=>r})},6174:(e,t,i)=>{i.d(t,{zu:()=>c,hZ:()=>o,CG:()=>l});var r=i(70375),n=i(39994);const s=i(13802).Z.getLogger("esri/views/webgl"),a=!!(0,n.Z)("enable-feature:webgl-debug");function o(){return a}function l(){return a}function c(e){if(o()){const t=e.getError();if(t){const i=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),n=(new Error).stack;s.error(new r.Z("webgl-error","WebGL error occured",{message:i,stack:n}))}}}},30560:(e,t,i)=>{function r(e,t,i){for(let r=0;r<i;++r)t[2*r]=e[r],t[2*r+1]=e[r]-t[2*r]}function n(e,t,i,n){for(let o=0;o<n;++o)s[0]=e[o],r(s,a,1),t[o]=a[0],i[o]=a[1]}i.d(t,{LF:()=>r,po:()=>n});const s=new Float64Array(1),a=new Float32Array(2)},91907:(e,t,i)=>{i.d(t,{Ld:()=>r,Lu:()=>s,_g:()=>n});const r=33984;var n;!function(e){e[e.Texture=0]="Texture",e[e.Buffer=1]="Buffer",e[e.VAO=2]="VAO",e[e.VertexShader=3]="VertexShader",e[e.FragmentShader=4]="FragmentShader",e[e.Program=5]="Program",e[e.Framebuffer=6]="Framebuffer",e[e.Renderbuffer=7]="Renderbuffer",e[e.COUNT=8]="COUNT"}(n||(n={}));const s=33306},17346:(e,t,i)=>{function r(e,t,i=32774,r=[0,0,0,0]){return{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:i,opAlpha:i,color:{r:r[0],g:r[1],b:r[2],a:r[3]}}}function n(e,t,i,r,n=32774,s=32774,a=[0,0,0,0]){return{srcRgb:e,srcAlpha:t,dstRgb:i,dstAlpha:r,opRgb:n,opAlpha:s,color:{r:a[0],g:a[1],b:a[2],a:a[3]}}}i.d(t,{jp:()=>R,zp:()=>o,BK:()=>c,LZ:()=>l,sg:()=>a,sm:()=>_,wK:()=>n,if:()=>r});const s={face:1029,mode:2305},a={face:1028,mode:2305},o=e=>2===e?s:1===e?a:null,l={zNear:0,zFar:1},c={r:!0,g:!0,b:!0,a:!0};function h(e){return T.intern(e)}function u(e){return w.intern(e)}function d(e){return y.intern(e)}function f(e){return A.intern(e)}function p(e){return z.intern(e)}function m(e){return C.intern(e)}function g(e){return O.intern(e)}function v(e){return E.intern(e)}function _(e){return N.intern(e)}class x{constructor(e,t){this.makeKey=e,this.makeRef=t,this.interns=new Map}intern(e){if(!e)return null;const t=this.makeKey(e),i=this.interns;return i.has(t)||i.set(t,this.makeRef(e)),i.get(t)}}function b(e){return"["+e.join(",")+"]"}const T=new x(S,(e=>({__tag:"Blending",...e})));function S(e){return e?b([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}const w=new x(M,(e=>({__tag:"Culling",...e})));function M(e){return e?b([e.face,e.mode]):null}const y=new x(I,(e=>({__tag:"PolygonOffset",...e})));function I(e){return e?b([e.factor,e.units]):null}const A=new x(P,(e=>({__tag:"DepthTest",...e})));function P(e){return e?b([e.func]):null}const z=new x(F,(e=>({__tag:"StencilTest",...e})));function F(e){return e?b([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}const C=new x(D,(e=>({__tag:"DepthWrite",...e})));function D(e){return e?b([e.zNear,e.zFar]):null}const O=new x(L,(e=>({__tag:"ColorWrite",...e})));function L(e){return e?b([e.r,e.g,e.b,e.a]):null}const E=new x(H,(e=>({__tag:"StencilWrite",...e})));function H(e){return e?b([e.mask]):null}const N=new x((function(e){return e?b([S(e.blending),M(e.culling),I(e.polygonOffset),P(e.depthTest),F(e.stencilTest),D(e.depthWrite),L(e.colorWrite),H(e.stencilWrite)]):null}),(e=>({blending:h(e.blending),culling:u(e.culling),polygonOffset:d(e.polygonOffset),depthTest:f(e.depthTest),stencilTest:p(e.stencilTest),depthWrite:m(e.depthWrite),colorWrite:g(e.colorWrite),stencilWrite:v(e.stencilWrite)})));class R{constructor(e){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=e}setPipeline(e){(this._pipelineInvalid||e!==this._pipeline)&&(this.setBlending(e.blending),this.setCulling(e.culling),this.setPolygonOffset(e.polygonOffset),this.setDepthTest(e.depthTest),this.setStencilTest(e.stencilTest),this.setDepthWrite(e.depthWrite),this.setColorWrite(e.colorWrite),this.setStencilWrite(e.stencilWrite),this._pipeline=e),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}setBlending(e){this._blending=this.setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}setCulling(e){this._culling=this.setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}setPolygonOffset(e){this._polygonOffset=this.setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}setDepthTest(e){this._depthTest=this.setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}setStencilTest(e){this._stencilTest=this.setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}setDepthWrite(e){this._depthWrite=this.setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}setColorWrite(e){this._colorWrite=this.setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}setStencilWrite(e){this._stencilWrite=this.setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}setSubState(e,t,i,r){return(i||e!==t)&&(r(e),this._pipelineInvalid=!0),e}}}}]);
//# sourceMappingURL=1255.js.map