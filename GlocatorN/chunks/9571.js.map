{"version":3,"file":"chunks/9571.js","mappings":"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","sources":["webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/engine/Bitmap.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/engine/BitmapContainer.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/layers/graphics/HighlightGraphicContainer.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/layers/MapImageLayerView.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/viewStateUtils.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","webpack://momraGisCore/./node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/maybe.js\";import{b as e,c as i,r as s,j as r,m as h}from\"../../../chunks/mat3.js\";import{c as n}from\"../../../chunks/mat3f32.js\";import{f as u}from\"../../../chunks/vec2f32.js\";import{DisplayObject as o}from\"./DisplayObject.js\";import a from\"./ImageryBitmapSource.js\";import d from\"../../webgl/Texture.js\";function c(t){return t&&\"render\"in t}function l(t){return t&&!(\"render\"in t)}function x(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function _(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new d(t,s)}class g extends o{constructor(t=null,e,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:n()}}setTransform(t){const n=e(this.transforms.dvs),[o,a]=t.toScreenNoRotation([0,0],[this.x,this.y]),d=this.resolution/this.pixelRatio/t.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;i(n,n,u(o,a)),i(n,n,u(c/2,l/2)),s(n,n,-x),i(n,n,u(-c/2,-l/2)),r(n,n,u(c,l)),h(this.transforms.dvs,t.displayViewMat3,n)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}updateTexture(e){var i;if(!this.stage)return null==(i=this._texture)||i.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=_(e,this.sourceWidth,this.sourceHeight):this._texture=_(e));const s=this.source;if(s){if(this._texture.resize(this.sourceWidth,this.sourceHeight),c(s))if(s instanceof a){const e=s.getRenderedRasterPixels();this._texture.setData(t(e)?e.renderedRasterPixels:null)}else this._texture.setData(x(s));else l(s)&&this._texture.setData(s);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}export{g as Bitmap,c as isImageSource,x as rasterize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{brushes as e}from\"./brushes.js\";import{WGLDrawPhase as r}from\"./webgl/enums.js\";import s from\"./webgl/WGLContainer.js\";class t extends s{get requiresDedicatedFBO(){return this.children.some((e=>\"additive\"===e.blendFunction))}prepareRenderPasses(s){const t=s.registerRenderPass({name:\"bitmap\",brushes:[e.bitmap],target:()=>this.children,drawPhase:r.MAP});return[...super.prepareRenderPasses(s),t]}}export{t as BitmapContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";class i{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return e(this.pixelBlock)?this.pixelBlock.width:0}get height(){return e(this.pixelBlock)?this.pixelBlock.height:0}render(e){const i=this.pixelBlock;if(t(i))return;const l=this.filter({pixelBlock:i});if(t(l.pixelBlock))return;const r=l.pixelBlock.getAsRGBA(),o=e.createImageData(l.pixelBlock.width,l.pixelBlock.height);o.data.set(r),e.putImageData(o,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return t(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import\"../../../../core/Logger.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/set.js\";import{subclass as e}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WGLDrawPhase as s}from\"../../engine/webgl/enums.js\";import t from\"./BaseGraphicContainer.js\";let o=class extends t{renderChildren(r){if(r.drawPhase!==s.HIGHLIGHT)return;if(this.attributeView.bindTextures(r.context),!this.children.some((r=>r.hasData)))return;super.renderChildren(r);const{painter:e}=r,t=e.effects.highlight;t.bind(r),r.context.setColorMask(!0,!0,!0,!0),r.context.clear(16384),this._renderChildren(r,t.defines.concat([\"highlightAll\"])),t.draw(r),t.unbind()}};o=r([e(\"esri.views.2d.layers.support.HighlightGraphicContainer\")],o);const i=o;export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as i}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as p}from\"../../layers/support/ExportImageParameters.js\";import{calculateTolerance as l}from\"../../renderers/support/clickToleranceUtils.js\";import{loadArcade as m}from\"../../support/arcadeOnDemand.js\";import{getRequiredFields as n,getFetchPopupTemplate as c}from\"./support/popupUtils.js\";import{getLayerFloorFilterClause as u}from\"../support/floorFilterUtils.js\";const y=y=>{let d=class extends y{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"mapimagelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));const i=this.get(\"view.scale\"),p=[],m=async e=>{const r=0===e.minScale||i<=e.minScale,o=0===e.maxScale||i>=e.maxScale;if(e.visible&&r&&o)if(e.sublayers)e.sublayers.forEach(m);else if(e.popupEnabled){const r=c(e,{...s,defaultPopupTemplateEnabled:!1});t(r)&&p.unshift({sublayer:e,popupTemplate:r})}},y=a.sublayers.toArray().reverse().map(m);await Promise.all(y);const d=p.map((async({sublayer:r,popupTemplate:o})=>{await r.load().catch((()=>{}));const a=r.createQuery(),i=t(s)?s.event:null,p=l({renderer:r.renderer,event:i}),m=this.createFetchPopupFeaturesQueryGeometry(e,p);if(a.geometry=m,a.outFields=await n(r,o),\"map-image\"===this.layer.type&&\"floors\"in this.view){var c,y;const e=null==(c=this.view)||null==(y=c.floors)?void 0:y.clone(),o=u(e,r);t(o)&&(a.where=a.where?`(${a.where}) AND (${o})`:o)}const d=await this._loadArcadeModules(o);d&&d.arcadeUtils.hasGeometryOperations(o)||(a.maxAllowableOffset=m.width/p);return(await r.queryFeatures(a)).features}));return(await o(d)).reduce(((e,r)=>r.value?[...e,...r.value]:e),[]).filter((e=>null!=e))}canResume(){var e;return!!super.canResume()&&(null==(e=this.timeExtent)||!e.isEmpty)}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\")||Array.isArray(e.content)&&e.content.some((e=>\"expression\"===e.type)))return m()}};return e([s()],d.prototype,\"exportImageParameters\",void 0),e([s({readOnly:!0})],d.prototype,\"exportImageVersion\",null),e([s()],d.prototype,\"layer\",void 0),e([s()],d.prototype,\"suspended\",void 0),e([s(i)],d.prototype,\"timeExtent\",void 0),d=e([a(\"esri.views.layers.MapImageLayerView\")],d),d};export{y as MapImageLayerView,y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{isAbortError as r}from\"../../../core/promiseUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as a}from\"../../../support/GraphicsCollection.js\";import{BitmapContainer as o}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as h}from\"./LayerView2D.js\";import p from\"./graphics/GraphicsView2D.js\";import m from\"./graphics/HighlightGraphicContainer.js\";import n from\"./support/ExportStrategy.js\";import c from\"../../layers/LayerView.js\";import{MapImageLayerView as d}from\"../../layers/MapImageLayerView.js\";import{RefreshableLayerView as g}from\"../../layers/RefreshableLayerView.js\";import{createQueryGeometry as l}from\"../../support/drapedUtils.js\";const u=t.getLogger(\"esri.views.2d.layers.MapImageLayerView2D\");let f=class extends(d(g(h(c)))){constructor(){super(...arguments),this._highlightGraphics=new a}update(e){this.strategy.update(e).catch((e=>{r(e)||u.error(e)}))}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:r}=this.layer,i=r>=10.3,s=r>=10;this._bitmapContainer=new o,this.container.addChild(this._bitmapContainer);const a=new p({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new m(this.view.featuresTilingScheme)});this.container.addChild(a.container),this.strategy=new n({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:i,imageNormalizationSupported:s,hidpi:!0}),this.handles.add(this.watch(\"exportImageVersion\",(()=>this.requestUpdate())),\"exportImageVersion\"),this.handles.add(this.watch(\"view.floors\",(()=>this.requestUpdate())),\"view.floors\"),this.requestUpdate()}detach(){this.handles.remove(\"exportImageVersion\"),this.handles.remove(\"view.floors\"),this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}highlight(e,t){return this._highlightGraphics.add(e),{remove:()=>{this._highlightGraphics.remove(e)}}}createFetchPopupFeaturesQueryGeometry(e,t){return l(e,t,this.view)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.timeExtent,floors:this.view.floors,...i})}};e([i()],f.prototype,\"strategy\",void 0),e([i()],f.prototype,\"updating\",void 0),f=e([s(\"esri.views.2d.layers.MapImageLayerView2D\")],f);const y=f;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nconst t=Math.PI/180;function n(n){return n*t}function o(t,n,o){const{resolution:r,size:u}=o;return t[0]=r*(Math.round(n[0]/r)+u[0]%2*.5),t[1]=r*(Math.round(n[1]/r)+u[1]%2*.5),t}function r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}function a(t,n){const[o,r,u,a]=t,[s,c,i,e]=n;return!(o>i||u<s||r>e||a<c)}export{a as bboxIntersects,u as getBBox,r as getOuterSize,o as snapToPixel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Accessor.js\";import{debounce as i}from\"../../../../core/promiseUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../../geometry/Extent.js\";import{create as a}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as p}from\"../../../../geometry/support/spatialReferenceUtils.js\";import n from\"../../../../layers/support/TileInfo.js\";import{getOuterSize as m,getBBox as l}from\"../../viewStateUtils.js\";import{Bitmap as d}from\"../../engine/Bitmap.js\";import h from\"../../tiling/TileInfoView.js\";import c from\"../../tiling/TileKey.js\";const u=a(),g=[0,0],f=new c(0,0,0,0),x={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let y=class extends e{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=x.hidpi,this.imageMaxWidth=x.imageMaxWidth,this.imageMaxHeight=x.imageMaxHeight,this.imageRotationSupported=x.imageRotationSupported,this.imageNormalizationSupported=x.imageNormalizationSupported,this.update=i((async(t,e)=>{if(!t.stationary||this.destroyed)return null;const i=t.state,o=p(i.spatialReference),r=this.hidpi?t.pixelRatio:1,s=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0];s?(g[0]=i.worldScreenWidth,g[1]=i.size[1]):this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):m(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,n=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),l=!this.imageNormalizationSupported&&n,d=!a&&!l,h=this.imageRotationSupported?i.rotation:0;if(d){const t=s?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,g,t,i.resolution,h,r,e)}else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);l&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,h,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=t?t:[];for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e),e.invalidateTexture(),e.requestRender()}}async _export(t,e,i,o,r,s){const a=await this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}),p=new d(a,\"additive\");return p.x=t.xmin,p.y=t.ymax,p.resolution=t.width/e,p.rotation=o,p.pixelRatio=r,p}async _singleExport(t,e,i,o,r,a,p){l(u,i,o,e);const n=new s(u[0],u[1],u[2],u[3],t.spatialReference);return[await this._export(n,e[0],e[1],r,a,p)]}_tiledExport(t,e,i,o,r){const a=n.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new h(a),m=p.getTileCoverage(t);if(!m)return null;const l=[];return m.forEach(((a,n,m,d)=>{f.set(a,n,m,d),p.getTileBounds(u,f);const h=new s(u[0],u[1],u[2],u[3],t.spatialReference);l.push(this._export(h,e,e,i,o,r))})),Promise.all(l)}};t([o()],y.prototype,\"_imagePromise\",void 0),t([o()],y.prototype,\"bitmaps\",void 0),t([o()],y.prototype,\"container\",void 0),t([o()],y.prototype,\"fetchSource\",void 0),t([o()],y.prototype,\"hidpi\",void 0),t([o()],y.prototype,\"imageMaxWidth\",void 0),t([o()],y.prototype,\"imageMaxHeight\",void 0),t([o()],y.prototype,\"imageRotationSupported\",void 0),t([o()],y.prototype,\"imageNormalizationSupported\",void 0),t([o()],y.prototype,\"requestUpdate\",void 0),t([o()],y.prototype,\"updating\",null),y=t([r(\"esri.views.2d.layers.support.ExportStrategy\")],y);const S=y;export{S as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n"],"names":["_","t","e","i","s","target","pixelFormat","internalFormat","dataType","wrapMode","width","height","g","constructor","super","this","requestRenderOnSourceChangedEnabled","_textureInvalidated","stencilRef","coordScale","_height","pixelRatio","resolution","rotation","_source","_width","x","y","blendFunction","source","requestRender","bind","destroy","_texture","dispose","isSourceScaled","sourceWidth","sourceHeight","invalidateTexture","HTMLImageElement","naturalHeight","naturalWidth","beforeRender","updateTexture","context","_createTransforms","dvs","setTransform","n","transforms","o","a","toScreenNoRotation","d","c","l","Math","PI","displayViewMat3","setSamplingProfile","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","bindTexture","stage","resize","getRenderedRasterPixels","setData","renderedRasterPixels","document","createElement","render","getContext","ready","onAttach","onDetach","requiresDedicatedFBO","children","some","prepareRenderPasses","registerRenderPass","name","brushes","drawPhase","pixelBlock","extent","originalPixelBlock","filter","r","getAsRGBA","createImageData","data","set","putImageData","Uint8Array","buffer","renderChildren","attributeView","bindTextures","hasData","painter","effects","highlight","setColorMask","clear","_renderChildren","defines","concat","draw","unbind","initialize","exportImageParameters","layer","exportImageVersion","commitProperty","_get","async","Promise","reject","get","p","m","minScale","maxScale","visible","sublayers","forEach","popupEnabled","defaultPopupTemplateEnabled","unshift","sublayer","popupTemplate","toArray","reverse","map","all","load","catch","createQuery","event","renderer","createFetchPopupFeaturesQueryGeometry","geometry","outFields","type","view","floors","clone","where","_loadArcadeModules","arcadeUtils","hasGeometryOperations","maxAllowableOffset","queryFeatures","features","reduce","value","canResume","timeExtent","isEmpty","Array","isArray","content","prototype","readOnly","u","f","arguments","_highlightGraphics","update","strategy","error","attach","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","graphics","requestUpdateCallback","requestUpdate","featuresTilingScheme","fetchSource","fetchImage","imageRotationSupported","imageNormalizationSupported","hidpi","handles","add","watch","detach","remove","removeAllChildren","moveStart","viewChange","moveEnd","isUpdating","updating","updateRequested","abs","cos","sin","size","round","_imagePromise","bitmaps","stationary","destroyed","state","spatialReference","worldScreenWidth","floor","xmin","valid","xmax","h","paddedViewState","center","_singleExport","min","_tiledExport","then","includes","fadeOut","fadeIn","updateExports","signal","ymax","_export","scales","scale","getTileCoverage","getTileBounds","push","S","doRefresh","dataChanged","declaredClass","getRequiredFields","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","has","indexOf","keyField","defaultPopupTemplate"],"sourceRoot":""}